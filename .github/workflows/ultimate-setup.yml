name: Codex Ultimate Zero-Error Setup
on: [push, workflow_dispatch]

jobs:
  setup:
    runs-on: ubuntu-latest
    steps:
      - name: 1. æ‹‰å–ä»£ç 
        uses: actions/checkout@v4

      - name: 2. æ™ºèƒ½ Python é…ç½®
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - name: Python ä¾èµ–å®‰è£…ä¸é«˜é˜¶æ£€æŸ¥
        run: |
          python -m pip install --upgrade pip
          pip install ruff bandit
          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
          ruff check . || echo "è·³è¿‡é£æ ¼æ£€æŸ¥"
          bandit -r . -ll || echo "è·³è¿‡å®‰å…¨æ‰«æ"
          echo "âœ… Python ç¯å¢ƒå°±ç»ª"

      - name: 3. æ™ºèƒ½ Node.js é…ç½®
        uses: actions/setup-node@v4
        with:
          node-version: '20'
      - name: Node ä¾èµ–å®‰è£…
        run: |
          if [ -f package.json ]; then npm install; else echo "âœ… è·³è¿‡ï¼šæœªæ£€æµ‹åˆ° Node é¡¹ç›®"; fi

      - name: 4. æ™ºèƒ½ Go é…ç½®
        uses: actions/setup-go@v5
        with:
          go-version: '1.21'
      - name: Go ä¾èµ–å®‰è£…
        run: |
          if [ -f go.mod ]; then go mod download; else echo "âœ… è·³è¿‡ï¼šæœªæ£€æµ‹åˆ° Go é¡¹ç›®"; fi

      - name: 5. æ™ºèƒ½ Java é…ç½®
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
      - name: Java ä¾èµ–æ£€æŸ¥
        run: |
          if [ -f pom.xml ] || [ -f build.gradle ]; then echo "æ£€æµ‹åˆ° Java é¡¹ç›®"; else echo "âœ… è·³è¿‡ï¼šæœªæ£€æµ‹åˆ° Java é¡¹ç›®"; fi

      - name: 6. æ™ºèƒ½ Docker é…ç½®
        run: |
          if [ -f Dockerfile ]; then
            docker build . -t my-app
          else
            echo "âœ… è·³è¿‡ï¼šæœªæ£€æµ‹åˆ° Dockerfile"
          fi

      - name: 7. æœ€ç»ˆæ±‡æ€»
        run: echo "ğŸš€ Codex ç»ˆæç¯å¢ƒå·²å°±ç»ªï¼Œå…¨ç»¿é€šè¡Œï¼"
